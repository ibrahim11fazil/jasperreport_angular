"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var vg_overlay_play_1 = require("./vg-overlay-play");
var vg_api_1 = require("../core/services/vg-api");
var vg_states_1 = require("../core/states/vg-states");
var vg_fullscreen_api_1 = require("../core/services/vg-fullscreen-api");
describe('Videogular Player', function () {
    var overlayPlay;
    var ref;
    var api;
    var fsAPI;
    var controlsHidden;
    beforeEach(function () {
        ref = {
            nativeElement: {
                getAttribute: function (name) {
                    return name;
                }
            }
        };
        controlsHidden = {
            isHidden: {
                subscribe: function () { }
            }
        };
        api = new vg_api_1.VgAPI();
        fsAPI = new vg_fullscreen_api_1.VgFullscreenAPI();
        overlayPlay = new vg_overlay_play_1.VgOverlayPlay(ref, api, fsAPI, controlsHidden);
    });
    it('Should get media by id on init', function () {
        spyOn(api, 'getMediaById').and.returnValue({
            subscriptions: {
                bufferDetected: { subscribe: jasmine.createSpy('bufferDetected') }
            }
        });
        overlayPlay.vgFor = 'test';
        overlayPlay.onPlayerReady();
        expect(api.getMediaById).toHaveBeenCalledWith('test');
        expect(overlayPlay.target.subscriptions.bufferDetected.subscribe).toHaveBeenCalled();
    });
    describe('onClick', function () {
        beforeEach(function () {
            overlayPlay.target = {
                play: function () { },
                pause: function () { }
            };
        });
        it('current state play should set target to pause', function () {
            spyOn(overlayPlay, 'getState').and.callFake(function () { return vg_states_1.VgStates.VG_PLAYING; });
            spyOn(overlayPlay.target, 'pause');
            overlayPlay.onClick();
            expect(overlayPlay.getState).toHaveBeenCalled();
            expect(overlayPlay.target.pause).toHaveBeenCalled();
        });
        it('current state pause should set target to play', function () {
            spyOn(overlayPlay, 'getState').and.callFake(function () { return vg_states_1.VgStates.VG_PAUSED; });
            spyOn(overlayPlay.target, 'play');
            overlayPlay.onClick();
            expect(overlayPlay.getState).toHaveBeenCalled();
            expect(overlayPlay.target.play).toHaveBeenCalled();
        });
    });
    describe('getState', function () {
        beforeEach(function () {
            overlayPlay.target = {
                state: null
            };
        });
        it('if only one state returns that state', function () {
            overlayPlay.target.state = vg_states_1.VgStates.VG_PAUSED;
            expect(overlayPlay.getState()).toEqual(vg_states_1.VgStates.VG_PAUSED);
        });
        it('if more than one target should return pause if all of them are pause', function () {
            overlayPlay.target.state = [
                vg_states_1.VgStates.VG_PAUSED,
                vg_states_1.VgStates.VG_PAUSED,
                vg_states_1.VgStates.VG_PAUSED,
                vg_states_1.VgStates.VG_PAUSED
            ];
            expect(overlayPlay.getState()).toEqual(vg_states_1.VgStates.VG_PAUSED);
        });
        it('if more than one target should return play if any of them is play', function () {
            overlayPlay.target.state = [
                vg_states_1.VgStates.VG_PAUSED,
                vg_states_1.VgStates.VG_PLAYING,
                vg_states_1.VgStates.VG_PAUSED,
                vg_states_1.VgStates.VG_PAUSED
            ];
            expect(overlayPlay.getState()).toEqual(vg_states_1.VgStates.VG_PLAYING);
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmctb3ZlcmxheS1wbGF5LnNwZWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ2Zy1vdmVybGF5LXBsYXkuc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHFEQUFnRDtBQUNoRCxrREFBOEM7QUFFOUMsc0RBQWtEO0FBQ2xELHdFQUFxRTtBQUdyRSxRQUFRLENBQUMsbUJBQW1CLEVBQUU7SUFDMUIsSUFBSSxXQUEwQixDQUFDO0lBQy9CLElBQUksR0FBYyxDQUFDO0lBQ25CLElBQUksR0FBUyxDQUFDO0lBQ2QsSUFBSSxLQUFxQixDQUFDO0lBQzFCLElBQUksY0FBK0IsQ0FBQztJQUVwQyxVQUFVLENBQUM7UUFDUCxHQUFHLEdBQUc7WUFDRixhQUFhLEVBQUU7Z0JBQ1gsWUFBWSxFQUFFLFVBQUMsSUFBSTtvQkFDZixNQUFNLENBQUMsSUFBSSxDQUFDO2dCQUNoQixDQUFDO2FBQ0o7U0FDSixDQUFDO1FBRUYsY0FBYyxHQUFHO1lBQ2IsUUFBUSxFQUFFO2dCQUNOLFNBQVMsRUFBRSxjQUFPLENBQUM7YUFDdEI7U0FDZ0IsQ0FBQztRQUV0QixHQUFHLEdBQUcsSUFBSSxjQUFLLEVBQUUsQ0FBQztRQUNsQixLQUFLLEdBQUcsSUFBSSxtQ0FBZSxFQUFFLENBQUM7UUFDOUIsV0FBVyxHQUFHLElBQUksK0JBQWEsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxjQUFjLENBQUMsQ0FBQztJQUNyRSxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRTtRQUNqQyxLQUFLLENBQUMsR0FBRyxFQUFFLGNBQWMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUM7WUFDdkMsYUFBYSxFQUFFO2dCQUNYLGNBQWMsRUFBRSxFQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLEVBQUU7YUFDcEU7U0FDSixDQUFDLENBQUM7UUFFSCxXQUFXLENBQUMsS0FBSyxHQUFHLE1B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QUFRLENBQUMsVUFBVTtnQkFDbkIsb0JBQVEsQ0FBQyxTQUFTO2dCQUNsQixvQkFBUSxDQUFDLFNBQVM7YUFDckIsQ0FBQztZQUVGLE1BQU0sQ0FBQyxXQUFXLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsb0JBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoRSxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1ZnT3ZlcmxheVBsYXl9IGZyb20gXCIuL3ZnLW92ZXJsYXktcGxheVwiO1xuaW1wb3J0IHtWZ0FQSX0gZnJvbSBcIi4uL2NvcmUvc2VydmljZXMvdmctYXBpXCI7XG5pbXBvcnQge0VsZW1lbnRSZWZ9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQge1ZnU3RhdGVzfSBmcm9tIFwiLi4vY29yZS9zdGF0ZXMvdmctc3RhdGVzXCI7XG5pbXBvcnQgeyBWZ0Z1bGxzY3JlZW5BUEkgfSBmcm9tICcuLi9jb3JlL3NlcnZpY2VzL3ZnLWZ1bGxzY3JlZW4tYXBpJztcbmltcG9ydCB7IFZnQ29udHJvbHNIaWRkZW4gfSBmcm9tICcuLi9jb3JlL3NlcnZpY2VzL3ZnLWNvbnRyb2xzLWhpZGRlbic7XG5cbmRlc2NyaWJlKCdWaWRlb2d1bGFyIFBsYXllcicsICgpID0+IHtcbiAgICBsZXQgb3ZlcmxheVBsYXk6IFZnT3ZlcmxheVBsYXk7XG4gICAgbGV0IHJlZjpFbGVtZW50UmVmO1xuICAgIGxldCBhcGk6VmdBUEk7XG4gICAgbGV0IGZzQVBJOlZnRnVsbHNjcmVlbkFQSTtcbiAgICBsZXQgY29udHJvbHNIaWRkZW46VmdDb250cm9sc0hpZGRlbjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICByZWYgPSB7XG4gICAgICAgICAgICBuYXRpdmVFbGVtZW50OiB7XG4gICAgICAgICAgICAgICAgZ2V0QXR0cmlidXRlOiAobmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29udHJvbHNIaWRkZW4gPSB7XG4gICAgICAgICAgICBpc0hpZGRlbjoge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZTogKCkgPT4ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBhcyBWZ0NvbnRyb2xzSGlkZGVuO1xuXG4gICAgICAgIGFwaSA9IG5ldyBWZ0FQSSgpO1xuICAgICAgICBmc0FQSSA9IG5ldyBWZ0Z1bGxzY3JlZW5BUEkoKTtcbiAgICAgICAgb3ZlcmxheVBsYXkgPSBuZXcgVmdPdmVybGF5UGxheShyZWYsIGFwaSwgZnNBUEksIGNvbnRyb2xzSGlkZGVuKTtcbiAgICB9KTtcblxuICAgIGl0KCdTaG91bGQgZ2V0IG1lZGlhIGJ5IGlkIG9uIGluaXQnLCAoKSA9PiB7XG4gICAgICAgIHNweU9uKGFwaSwgJ2dldE1lZGlhQnlJZCcpLmFuZC5yZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzdWJzY3JpcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgYnVmZmVyRGV0ZWN0ZWQ6IHtzdWJzY3JpYmU6IGphc21pbmUuY3JlYXRlU3B5KCdidWZmZXJEZXRlY3RlZCcpIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgb3ZlcmxheVBsYXkudmdGb3IgPSAndGVzdCc7XG4gICAgICAgIG92ZXJsYXlQbGF5Lm9uUGxheWVyUmVhZHkoKTtcblxuICAgICAgICBleHBlY3QoYXBpLmdldE1lZGlhQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Rlc3QnKTtcbiAgICAgICAgZXhwZWN0KG92ZXJsYXlQbGF5LnRhcmdldC5zdWJzY3JpcHRpb25zLmJ1ZmZlckRldGVjdGVkLnN1YnNjcmliZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ29uQ2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICAgICAgb3ZlcmxheVBsYXkudGFyZ2V0ID0ge1xuICAgICAgICAgICAgICAgIHBsYXk6ICgpID0+IHsgfSxcbiAgICAgICAgICAgICAgICBwYXVzZTogKCkgPT4geyB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnY3VycmVudCBzdGF0ZSBwbGF5IHNob3VsZCBzZXQgdGFyZ2V0IHRvIHBhdXNlJywgKCkgPT4ge1xuICAgICAgICAgICAgc3B5T24ob3ZlcmxheVBsYXksICdnZXRTdGF0ZScpLmFuZC5jYWxsRmFrZSgoKSA9PiB7IHJldHVybiBWZ1N0YXRlcy5WR19QTEFZSU5HOyB9KTtcbiAgICAgICAgICAgIHNweU9uKG92ZXJsYXlQbGF5LnRhcmdldCwgJ3BhdXNlJyk7XG5cbiAgICAgICAgICAgIG92ZXJsYXlQbGF5Lm9uQ2xpY2soKTtcblxuICAgICAgICAgICAgZXhwZWN0KG92ZXJsYXlQbGF5LmdldFN0YXRlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICAgICAgICBleHBlY3Qob3ZlcmxheVBsYXkudGFyZ2V0LnBhdXNlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdjdXJyZW50IHN0YXRlIHBhdXNlIHNob3VsZCBzZXQgdGFyZ2V0IHRvIHBsYXknLCAoKSA9PiB7XG4gICAgICAgICAgICBzcHlPbihvdmVybGF5UGxheSwgJ2dldFN0YXRlJykuYW5kLmNhbGxGYWtlKCgpID0+IHsgcmV0dXJuIFZnU3RhdGVzLlZHX1BBVVNFRDsgfSk7XG4gICAgICAgICAgICBzcHlPbihvdmVybGF5UGxheS50YXJnZXQsICdwbGF5Jyk7XG5cbiAgICAgICAgICAgIG92ZXJsYXlQbGF5Lm9uQ2xpY2soKTtcblxuICAgICAgICAgICAgZXhwZWN0KG92ZXJsYXlQbGF5LmdldFN0YXRlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICAgICAgICBleHBlY3Qob3ZlcmxheVBsYXkudGFyZ2V0LnBsYXkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZ2V0U3RhdGUnLCAoKSA9PiB7XG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICAgICAgb3ZlcmxheVBsYXkudGFyZ2V0ID0ge1xuICAgICAgICAgICAgICAgIHN0YXRlOiBudWxsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnaWYgb25seSBvbmUgc3RhdGUgcmV0dXJucyB0aGF0IHN0YXRlJywgKCkgPT4ge1xuICAgICAgICAgICAgb3ZlcmxheVBsYXkudGFyZ2V0LnN0YXRlID0gVmdTdGF0ZXMuVkdfUEFVU0VEO1xuXG4gICAgICAgICAgICBleHBlY3Qob3ZlcmxheVBsYXkuZ2V0U3RhdGUoKSkudG9FcXVhbChWZ1N0YXRlcy5WR19QQVVTRUQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnaWYgbW9yZSB0aGFuIG9uZSB0YXJnZXQgc2hvdWxkIHJldHVybiBwYXVzZSBpZiBhbGwgb2YgdGhlbSBhcmUgcGF1c2UnLCAoKSA9PiB7XG4gICAgICAgICAgICBvdmVybGF5UGxheS50YXJnZXQuc3RhdGUgPSBbXG4gICAgICAgICAgICAgICAgVmdTdGF0ZXMuVkdfUEFVU0VELFxuICAgICAgICAgICAgICAgIFZnU3RhdGVzLlZHX1BBVVNFRCxcbiAgICAgICAgICAgICAgICBWZ1N0YXRlcy5WR19QQVVTRUQsXG4gICAgICAgICAgICAgICAgVmdTdGF0ZXMuVkdfUEFVU0VEXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBleHBlY3Qob3ZlcmxheVBsYXkuZ2V0U3RhdGUoKSkudG9FcXVhbChWZ1N0YXRlcy5WR19QQVVTRUQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnaWYgbW9yZSB0aGFuIG9uZSB0YXJnZXQgc2hvdWxkIHJldHVybiBwbGF5IGlmIGFueSBvZiB0aGVtIGlzIHBsYXknLCAoKSA9PiB7XG4gICAgICAgICAgICBvdmVybGF5UGxheS50YXJnZXQuc3RhdGUgPSBbXG4gICAgICAgICAgICAgICAgVmdTdGF0ZXMuVkdfUEFVU0VELFxuICAgICAgICAgICAgICAgIFZnU3RhdGVzLlZHX1BMQVlJTkcsXG4gICAgICAgICAgICAgICAgVmdTdGF0ZXMuVkdfUEFVU0VELFxuICAgICAgICAgICAgICAgIFZnU3RhdGVzLlZHX1BBVVNFRFxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgZXhwZWN0KG92ZXJsYXlQbGF5LmdldFN0YXRlKCkpLnRvRXF1YWwoVmdTdGF0ZXMuVkdfUExBWUlORyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4iXX0=